import{j as e}from"./index-DEaKLXWb.js";import{r as t}from"./vendor-Cg3t72uT.js";import{a,l as s,U as r,M as l,u as o,d}from"./logo-By-Ja5QZ.js";import{o as i,a as n}from"./firebase-CsTPUANe.js";import"./firebase-coe4MofA.js";import"./utils-CrM1Z76V.js";function c(){const[c,m]=t.useState([]),[x,h]=t.useState(!0),[g,p]=t.useState(""),u=(()=>{let e=localStorage.getItem("pv-meme-session-id");return e||(e=Math.random().toString(36).slice(2)+Date.now(),localStorage.setItem("pv-meme-session-id",e)),e})(),[v,j]=t.useState(null),[b,f]=t.useState(""),[y,w]=t.useState(null),[N,k]=t.useState(!1),[S,B]=t.useState(new Set),U=t.useCallback(e=>{B(t=>new Set([...t,e]))},[]);t.useEffect(()=>{const e=i(n,j);return()=>e()},[]),t.useEffect(()=>{h(!0),a(50).then(e=>{const t=e.filter(e=>e.imgDataUrl&&e.imgDataUrl.length>0&&e.imgDataUrl.startsWith("data:image/"));m(t)}).catch(e=>{p("Failed to load leaderboard.")}).finally(()=>h(!1))},[]);const C=async e=>{f("");const t=Date.now();t-Number(localStorage.getItem("pv-meme-last-upvote")||0)<5e3?f("You can only upvote once every 5 seconds. Please wait before upvoting again."):(await o(e,u),localStorage.setItem("pv-meme-last-upvote",t.toString()),m(t=>t.map(t=>t.id===e?{...t,upvotes:(t.upvotes||0)+1,upvotedBy:{...t.upvotedBy||{},[u]:!0}}:t)))},L=async e=>{await d(e),m(t=>t.filter(t=>t.id!==e)),k(!1)};return e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-gray-800 text-white p-4 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("img",{src:s,alt:"2.0 Logo",className:"h-10 w-10"}),e.jsx("h1",{className:"text-3xl font-bold",children:"PV Meme Generator"})]})}),e.jsx("main",{className:"p-4 md:p-6",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"max-w-3xl mx-auto bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center text-gray-900 dark:text-white",children:"🏆 Meme Leaderboard"}),b&&e.jsx("div",{className:"text-red-500 text-center mb-2",children:b}),x?e.jsx("p",{className:"text-gray-400 dark:text-gray-500",children:"Loading..."}):g?e.jsx("p",{className:"text-red-500",children:g}):0===c.length?e.jsx("p",{className:"text-gray-400 dark:text-gray-500",children:"No memes yet. Be the first to share one!"}):e.jsx("div",{className:"space-y-4",children:c.map((t,a)=>{const s=t.upvotedBy&&t.upvotedBy[u];return e.jsxs("div",{className:"flex items-center gap-4 bg-gray-50 dark:bg-gray-700 rounded p-3 shadow-sm",children:[e.jsx("span",{className:"font-bold text-lg w-6 text-center text-gray-900 dark:text-white",children:a+1}),e.jsx(r,{upvotes:t.upvotes||0,hasUpvoted:s,onUpvote:()=>C(t.id),disabled:s,size:"sm"}),e.jsxs("div",{className:"relative w-24 h-24",children:[!S.has(t.id)&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200 dark:bg-gray-600 rounded border",children:e.jsx("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"})}),e.jsx("img",{src:t.imgDataUrl,alt:"Meme",className:"w-24 h-24 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity "+(S.has(t.id)?"opacity-100":"opacity-0"),loading:"lazy",onClick:()=>(e=>{w(e),k(!0)})(t),onLoad:()=>U(t.id),onError:()=>U(t.id),title:"Click to view full size"})]}),e.jsxs("div",{className:"flex-1",children:[t.discordUsername&&e.jsxs("div",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:["@",t.discordUsername]}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Created: ",new Date(t.createdAt).toLocaleString()]})]}),v&&e.jsxs("button",{onClick:()=>L(t.id),className:"flex items-center gap-1 text-xs px-2 py-1 rounded bg-red-100 hover:bg-red-200 text-red-700 dark:bg-red-900 dark:text-red-300 dark:hover:bg-red-800",title:"Delete this meme",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 013-3h5a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2V3a1 1 0 016 0v1a1 1 0 001 1v1m0 0a1 1 0 001 1v1a1 1 0 001 1V4a1 1 0 001-1h5a1 1 0 001-1V2a1 1 0 001 1H10z"})}),"Delete"]})]},t.id)})})]})})}),e.jsxs("footer",{className:"mt-12 py-6 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 text-center text-gray-700 dark:text-gray-300 text-sm",children:[e.jsx("div",{className:"mb-2 font-semibold text-base text-gray-800 dark:text-gray-100",children:"Your Tips Help Support This Site!"}),e.jsxs("div",{className:"flex flex-col items-center gap-1 mb-2",children:[e.jsxs("span",{children:[e.jsx("span",{className:"font-bold",children:"SOL:"})," E7AUwAjXoacTSrqKMg5Ycnwhn6boMbc8tpEhbrKUviAw"]}),e.jsxs("span",{children:[e.jsx("span",{className:"font-bold",children:"ETH:"})," 0xd919d5304BE87E3159f6b1Cbd5516822F407B6eC"]}),e.jsxs("span",{children:[e.jsx("span",{className:"font-bold",children:"BTC:"})," bc1qs8nrgl4h3u0gje0acaufpufmumvxql7cvgfhej"]})]}),e.jsx("div",{className:"flex justify-center items-center gap-2 mt-2",children:e.jsxs("a",{href:"https://x.com/ruffriderx",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1200 1227",className:"w-5 h-5",fill:"currentColor",children:e.jsx("path",{d:"M1199.6 0 741 555.7 1199.6 1227H872.9L563.4 792.8 214.2 1227H0l485.8-594.7L43.6 0h337.7l261.2 366.2L985.8 0h213.8ZM917.7 1106.6h109.6L293.4 120.4h-114L917.7 1106.6Z"})}),e.jsx("span",{children:"Follow me on X"})]})})]}),y&&e.jsx(l,{isOpen:N,onClose:()=>{k(!1),w(null)},meme:y,onUpvote:async e=>{await C(e);const t=c.find(t=>t.id===e);t&&w(t)},upvotedMemes:e=>e.upvotedBy&&e.upvotedBy[u]||!1,isAdmin:v,onDelete:L})]})}export{c as default};
