import{d as e}from"./firebase-CsTPUANe.js";import{r as t,g as a,q as s,b as r,u as o,a as n,p as l}from"./firebase-coe4MofA.js";import{j as i}from"./index-DEaKLXWb.js";import"./vendor-Cg3t72uT.js";async function d(s){var r;const n=t(e,"memes"),i=l(n);if(await o(i,{...s,upvotes:0,upvotedBy:{}}),s.templateId){const n=t(e,`templateUsage/${s.templateId}`);await o(n,{lastUsed:Date.now(),usageCount:(null==(r=(await a(n)).val())?void 0:r.usageCount)+1||1})}return i.key}async function c(s,r){const n=t(e,`memes/${s}`),l=await a(n);if(!l.exists())return!1;const i=l.val();return(!i.upvotedBy||!i.upvotedBy[r])&&(await o(n,{upvotes:(i.upvotes||0)+1,[`upvotedBy/${r}`]:!0}),!0)}async function m(s=20){try{const r=t(e,"memes"),o=await a(r),n=[];return o.forEach(e=>{const t={id:e.key,...e.val()};n.push(t)}),n.sort((e,t)=>(t.upvotes||0)-(e.upvotes||0)),n.slice(0,s)}catch(r){throw r}}async function x(o,n=10){const l=s(t(e,"memes"),r("templateId")),i=await a(l),d=[];return i.forEach(e=>{const t=e.val();if(t.templateId===o){if("number"!=typeof t.upvotes||!t.templateId||!t.templateName||!t.createdAt)return;d.push({id:e.key,...t})}}),d.sort((e,t)=>t.createdAt-e.createdAt),d.slice(0,n)}async function u(a){const s=t(e,`memes/${a}`);await n(s)}function h({upvotes:e=0,hasUpvoted:t=!1,onUpvote:a,disabled:s=!1,size:r="md"}){return i.jsxs("div",{className:"flex flex-col items-center gap-1",children:[i.jsx("button",{onClick:a,disabled:s||t,className:`\n          ${{sm:"w-6 h-6 text-xs",md:"w-8 h-8 text-sm",lg:"w-10 h-10 text-base"}[r]} \n          flex items-center justify-center rounded-full border-2 transition-all duration-200\n          ${t?"bg-orange-500 border-orange-500 text-white shadow-md":"bg-white border-gray-300 text-gray-600 hover:border-orange-400 hover:text-orange-500 hover:bg-orange-50"}\n          ${s?"opacity-50 cursor-not-allowed":"cursor-pointer hover:scale-105"}\n        `,title:t?"You upvoted this meme":"Upvote this meme",children:i.jsx("svg",{className:{sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"}[r],fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})})}),i.jsx("span",{className:`font-semibold ${t?"text-orange-600":"text-gray-700"} ${"sm"===r?"text-xs":"lg"===r?"text-base":"text-sm"}`,children:e})]})}function p({meme:e,isOpen:t,onClose:a,onUpvote:s,canUpvote:r,onDelete:o,canDelete:n}){if(!t||!e)return null;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&a()},children:i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl max-h-[90vh] overflow-auto shadow-xl",children:[i.jsxs("div",{className:"flex justify-between items-center p-4 border-b dark:border-gray-700",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Meme Details"}),i.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-2xl leading-none","aria-label":"Close modal",children:"Ã—"})]}),i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"mb-4 text-center",children:i.jsx("img",{src:e.imgDataUrl,alt:"Meme",className:"max-w-full max-h-96 mx-auto rounded border dark:border-gray-600 shadow-sm",style:{objectFit:"contain"}})}),i.jsxs("div",{className:"space-y-2 mb-4",children:[e.discordUsername&&i.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[i.jsx("span",{className:"font-medium",children:"Created by:"})," @",e.discordUsername]}),i.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[i.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(e.createdAt).toLocaleString()]})]}),i.jsxs("div",{className:"flex gap-3 justify-center items-center",children:[i.jsx(h,{upvotes:e.upvotes||0,hasUpvoted:!r,onUpvote:()=>s(e.id),disabled:!r,size:"lg"}),n&&i.jsxs("button",{onClick:()=>o(e.id),className:"flex items-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9zM4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 102 0v3a1 1 0 11-2 0V9zm4 0a1 1 0 10-2 0v3a1 1 0 102 0V9z",clipRule:"evenodd"})}),"Delete"]})]})]})]})})}const v="/assets/logo-fmo-MDi0.png";export{p as M,h as U,m as a,u as d,x as g,v as l,d as s,c as u};
